# 数据库

## 一、索引

### 解释各种树

| 名称 | 特点 | 应用 |
| ---- | ---- | ---- |
| 二叉树 | 每个节点最多包含两个子节点 | 无 |
| 满二叉树 | 叶子节点都在同一层，且除叶子节点外的所有节点都有两个子节点 | 无 |
| 完全二叉树 | 除最后一层外所有节点构成满二叉树，最后一层节点从左到右紧密排列 | 无 |
| 平衡二叉树（AVL） | 高度差不大于1 | 无 |
| 二叉搜索树 | 左子树均比根节点小，右子树均比根节点大 | 无 |
| 霍夫曼树 | 为节点加权，使其代带权路径最短 | 数据压缩 |
| 红黑树 | 为二叉查找树节点增加颜色，使其具有更复杂操作 | hashMap树化 |
| B树 | 多路平衡查找树 | 无 |
| B+树 | B数的进阶，更有利于查找 | InnoDB索引 |

### 聚簇索引和非聚簇索引的区别
    聚簇索引：数据与索引存储在一起，索引结构的叶子节点保存了行数据，提升了查询速度，大大降低了磁盘IO次数
    非聚簇索引：数据与索引分开存储，索引结构的叶子节点指向了数据对应的位置
    
### 聚簇索引存在的问题
    1.影响数据写入速度:
    2.更新聚簇索引代价较高：会将需要更新的行移动到新位置

聚簇索引的优缺点[https://www.tqwba.com/x_d/jishu/140664.html]()

## 二、数据库隔离级别

| 隔离级别 | 脏读 | 不可重复读 | 幻读 |
| ---- | ---- | ---- | ---- |
| 读未提交 | 是 | 是 | 是 |
| 读已提交 | 否 | 是 | 是 |
| 可重复度 | 否 | 否 | 是 |
| 串行化 | 否 | 否 | 否 |

### 解释脏读、不可重复读、幻读
    脏读：A读到了B未提交的数据
    不可重复读：  A两次读取的数据不一致，其他事务有修改
    幻读：A读到了B Insert的数据
    
### A事务查询，同时B事务修改（同一条数据），查询到的是修改前还是修改后？
    答：修改前，因为普通select语句做的是快照读。
    
### mysql为什么选择可重复读作为默认隔离级别
    由于历史原因，mysql选择可重复读作为默认隔离级别，保证主从复制不出问题

## 三.数据库引擎

### InnoDB是怎样存储数据的
    InnoDB采用页来保存数据，页大小一般是16kb。
    为了减少磁盘随机读取次数，InnoDB采用页而不是行的粒度来保存数据，页与页之间是双向链表，每个页中的数据按主键排序组成单向链表，
    每个页还有一个页目录，方便按照主键查询，降低搜索时间复杂度

### InnoDB支持高并发手段
        1.普通锁：事务串行执行
        2.读写锁：读读并行
        3.MVCC:读写并行

InnoDB是怎样支持高并发的：[https://www.jianshu.com/p/1b079b0e3f40](https://www.jianshu.com/p/1b079b0e3f40)

## 四、数据库三范式

### 对数据库三范式的理解，并举例说明为什么不满足
    第一范式：确保每一列的原子性，不可再拆分
            例：电话列存储了固定电话和移动电话两种数据
    第二范式：在一基础上，表中的字段必须完全依赖于全部主键而非部分主键（主要针对联合主键）
            例：主键（学号、学校），列学校地址只与主键列的学校相关
    第三范式：在二基础上，非主键外所有字段必须互不依赖
            例：主键（订单）、顾客编号、顾客姓名，顾客姓名->顾客编号->订单存在依赖传递
    总结：数据库设计不会严格遵循三范式，要以：需求>性能>表结构，的顺序设计
详解数据库三范式：[https://blog.csdn.net/Wenco1/article/details/88077279?utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control]()

## 五、SQL注入

### 怎样防止SQL注入，举一个SQL注入的例子
    1.检查变量数据类型和格式
        如SQL:where id={$id}，可以提前检查id是否是INT类型。但文章发布系统、论坛等必须允许用户提交任意字符串的场景无法限制
    2.过滤特殊符号
        如过考虑delete、update、@等SQL关键字
    3.使用预编译语句PrepareStatement
        原理：程序首先会对该sql语句进行预编译，然后在传入的参数两边自动添加单引号，以字符串方式处理，同时会解析每个字符，对其转义处理

## 六、redis

### redis集群

### redis主从复制

### 布隆过滤器原理